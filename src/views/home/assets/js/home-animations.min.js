// AUDIO
const backgroundWaveAudio = new Audio("assets/audio/backgroundWaveAudio.wav");
const footerInWaveAudio = new Audio("assets/audio/footerInWaveAudio.wav");
const footerOutWaveAudio = new Audio("assets/audio/footerOutWaveAudio.wav");
const headerWindAudio = new Audio("assets/audio/headerWindAudio.wav");
const logoWindAudio = new Audio("assets/audio/logoWindAudio.wav");
const donateButtonShakeAudio = new Audio("assets/audio/donateButtonShakeAudio.mp3");
const orderLinkAudioOne = new Audio("assets/audio/orderLinkAudioOne.wav");
const orderLinkAudioTwo = new Audio("assets/audio/orderLinkAudioTwo.wav");
const orderLinkAudioThree = new Audio("assets/audio/orderLinkAudioThree.wav");
const orderLinkAudioFour = new Audio("assets/audio/orderLinkAudioFour.wav");
const bellAudioOne = new Audio("assets/audio/bellAudioOne.wav");
const bellAudioTwo = new Audio("assets/audio/bellAudioTwo.wav");
const audioArray = [backgroundWaveAudio, footerInWaveAudio, footerOutWaveAudio, headerWindAudio, logoWindAudio, orderLinkAudioOne, orderLinkAudioTwo, orderLinkAudioThree, orderLinkAudioFour, donateButtonShakeAudio, bellAudioOne, bellAudioTwo];

// MUSIC
// const firstMusic = new Audio("assets/audio/Shemrooni - Meet The Sun.mp3");

const musicArray = [];
const soundArray = [backgroundWaveAudio, footerInWaveAudio, footerOutWaveAudio, headerWindAudio, logoWindAudio, orderLinkAudioOne, orderLinkAudioTwo, orderLinkAudioThree, orderLinkAudioFour, donateButtonShakeAudio, bellAudioOne, bellAudioTwo];

var isAudioMuted = false;
var isMusicMuted = false;
var isSoundMuted = false;

// FUNCTIONS

// Toggles between music and sound effects
function toggleMuteSoundEffects (effect, setMute) {
    switch (effect) {
        case 'audio':
            audioArray.forEach(audio => {
                audio.muted = setMute;
            });
            break;

        case 'music':
            musicArray.forEach(music => {
                music.muted = setMute;
            });
            break;
    
        default:
            soundArray.forEach(sound => {
                sound.muted = setMute;
            });
            break;
    }
}

// Prevents mouse pointer from being changed on hovers
function hoverPointerChangePreventer (e) {
    e = e || window.event;
    e.preventDefault();
}

// Sound effects on handler
function acceptHandler() {
    $(document).trigger("sound-on");
}

// Sound effects off handler
function rejectHandler() {
    $(document).trigger("sound-off");
}

// Load main page
function loadPage() {
    $('#soundMessage').addClass('animate__flash');
    setTimeout(() => {
        $("#question").addClass('animate__bounceOut');
        setTimeout(() => {
        $("#question").addClass('d-none');
            $(document).trigger('start-animation');
        }, 1000);
    }, 2000);
}

// $('#enableSound').on('mouseenter', function () {
//     $('#enableSound').addClass('enableSoundHover');
// })

// $('#disableSound').on('mouseenter', function () {
//     $('#disableSound').addClass('disableSoundHover');
// })

// $('#enableSound').mousedown(function () {
//     $('#enableSound').removeClass('enableSoundHover');
//     $('#enableSound').addClass('optionClick');
//     // console.log($('#enableSound').classList)
// })

// $('#disableSound').mousedown(function () {
//     $('#disableSound').removeClass('disableSoundHover');
//     $('#disableSound').addClass('optionClick');
//     // console.log($('#enableSound').classList)
// })

$(document).on('sound-on', function () {
    $('#soundMessage').html('ENABLED');
    $('#soundMessage').css('color', 'green');
    loadPage();
})

$(document).on('sound-off', function () {
    $('#soundMessage').html('DISABLED');
    $('#soundMessage').css('color', 'red');
    toggleMuteSoundEffects('all', true);
    loadPage();
})

$(document).ready(function () {
    $('#loader').addClass('d-none')
    $('#question').removeClass('d-none')
})
  
// Sets initial volumes
$(document).on('start-animation', function () {

    backgroundWaveAudio.volume = 0.15;
    headerWindAudio.volume = 0.58;
    logoWindAudio.volume = 0.6;
    orderLinkAudioOne.volume = 0.3;
    orderLinkAudioTwo.volume = 0.3;
    orderLinkAudioThree.volume = 0.3;
    orderLinkAudioFour.volume = 0.3;
    donateButtonShakeAudio.volume = 0.2;
    footerOutWaveAudio.volume = 0.25;

    backgroundWaveAudio.loop = true;
    backgroundWaveAudio.play();

    // Starts showcase animation
    setTimeout(() => {
        $('#mainContainer').removeClass('d-none');
        $('#mainContainer').addClass('d-flex flex-column bounce-in-initial');  
    }, 1000);    
});
  
$(document).on('start-animation', function () {

    var intervalRef;
    var initialIntervalRef;
    var logoTimeOutRef;
    var orderNavTimeOutRef;
    var portNavTimeOutRef;
    var appNavTimeOutRef;
    
    // Creates wind effect on logo and navbar icons with sound effects with customizable delays
    function windEffect (initialDelay, beforeApp, beforePort, beforeOrder) {

        logoTimeOutRef = setTimeout(() => {
            $('#logo').addClass('shake-top');
            headerWindAudio.play();
            
            setTimeout(() => {
                bellAudioOne.play();
                bellAudioTwo.play();
            }, 800);

            orderNavTimeOutRef = setTimeout(() => {
                $('#appNav').addClass('shake-top');
                bellAudioTwo.play();
                bellAudioOne.play();

                portNavTimeOutRef = setTimeout(() => {
                    $('#portNav').addClass('shake-top');
                    bellAudioTwo.play();
                    bellAudioOne.play();

                    appNavTimeOutRef = setTimeout(() => {
                        $('#orderNav').addClass('shake-top');
                        bellAudioTwo.play();
                        bellAudioOne.play();
                    }, beforeOrder);
                }, beforePort);
            }, beforeApp);
        }, initialDelay);
    }

    // Clears wind effect timeouts
    function clearWindEffect () {
        clearTimeout(logoTimeOutRef);
        clearTimeout(orderNavTimeOutRef);
        clearTimeout(portNavTimeOutRef);
        clearTimeout(appNavTimeOutRef);
        clearInterval(intervalRef);
        $('#appNav, #portNav, #orderNav, #logo').removeClass('shake-top');
    }

    // Logo hover effect
    $('#logo').on('mouseenter', function () {
        $('#logo').removeClass('animate__swing text-focus-in');
        $('#logo').addClass('pulsate-fwd-internal');
        // windAudio.play();
    });

    // Logo mouse leave effect
    $('#logo').on('mouseleave', function () {
        $('#logo').removeClass('pulsate-fwd-internal');
        $('#logo').addClass('animate__swing');
    });

    // Initial logo and navbar animations
    setTimeout(() => {
        $('#logo').removeClass('invisible');
        $('#logo').addClass('text-focus-in');
        logoWindAudio.play();
        
        setTimeout(() => {
            $('#appNav, #portNav, #orderNav').removeClass('invisible');
            $('#appNav, #portNav, #orderNav').addClass('navbar-tracking-in-expand');
        }, 5300);
    }, 3500);

    // Logo and navbar running animation loop
    setTimeout(() => {
        $('#appNav, #portNav, #orderNav, #logo').removeClass('navbar-tracking-in-expand animate__swing shake-top text-focus-in');
        windEffect(100, 800, 400, 400);
    }, 14500);

    initialIntervalRef = setInterval(() => {
        clearWindEffect();
        bellAudioOne.volume = 0.2;
        bellAudioTwo.volume = 0.2;
        windEffect(1000, 900, 450, 450);
    }, 33000);

    // Stops navbar animation loop on hover
    $('#appNav, #portNav, #orderNav, #logo').on('mouseenter', function () {
        clearInterval(initialIntervalRef);
        clearWindEffect();
    });
 
    // Resets the navbar animation loop on mouse leave
    $('#appNav, #portNav, #orderNav, #logo').on('mouseleave', function () {
        intervalRef = setInterval(() => {
            $('#appNav, #portNav, #orderNav, #logo').removeClass('navbar-tracking-in-expand animate__swing shake-top');
            windEffect(1000, 1000, 500, 500);
        }, 13000);
    });
});

$(document).on('start-animation', function () {
    var visibilityTimeOutRef;
    var vibrationTimeOutRef;

    $('#soundSpan').on('click', function () {
        toggleMuteSoundEffects('all', !isAudioMuted);
        isAudioMuted = !isAudioMuted;
    });

    $('#musicSpan').on('click', function () {
        toggleMuteSoundEffects('music', !isMusicMuted);
        isMusicMuted = !isMusicMuted;
    });

    $('#audioSpan').on('click', function () {
        toggleMuteSoundEffects('audio', !isSoundMuted);
        isSoundMuted = !isSoundMuted;
    });

    setTimeout(() => {
        $('#soundSpan').removeClass('invisible');
        $('#soundSpan').addClass('roll-in-left');
    }, 8200);

    $('#soundSpan').on('mouseenter', function () {
        clearTimeout(visibilityTimeOutRef);
        clearTimeout(vibrationTimeOutRef);
        $('#soundButton').removeClass('vibrate-1 animate__wobble');
        $('#soundButton').attr('src','assets/images/svg/music-hover.svg');
        $('#soundButton').animate({height:"108%",width:"108%"}, 300);
        $('#musicSpan, #audioSpan').removeClass('invisible');
        $('#musicButton, #audioButton').removeClass('invisible animate__rollOut');
        $('#musicButton, #audioButton').addClass('animate__rollIn');
    });
    
    $('#soundSpan').on('mouseleave', function () {
        $('#soundButton').animate({height:"100%",width:"100%"}, 150);
    });

    $('#soundDiv').on('mouseleave', function () {
        $('#soundButton').attr('src','assets/images/svg/music.svg');
        $('#musicButton, #audioButton').removeClass('animate__rollIn');
        $('#musicButton, #audioButton').addClass('animate__rollOut');
        $('#soundButton').addClass('animate__wobble');

        visibilityTimeOutRef = setTimeout(() => {
            $('#musicButton, #audioButton, #musicSpan, #audioSpan').addClass('invisible');
        }, 1000);

        vibrationTimeOutRef = setTimeout(() => {
            $('#soundButton').addClass('vibrate-1');
        }, 2500);
    });

    $('#musicButton').on('mouseenter', function () {
        $('#musicButton').attr('src','assets/images/svg/music-off-hover.svg');
        $('#musicButton').animate({height:"120%",width:"120%"}, 300);
    });

    $('#musicButton').on('mouseleave', function () {
        $('#musicButton').attr('src','assets/images/svg/music-on.svg');
        $('#musicButton').animate({height:"100%",width:"100%"}, 150);
    });

    $('#audioButton').on('mouseenter', function () {
        $('#audioButton').attr('src','assets/images/svg/volume-off-hover.svg');
        $('#volumeSpan').removeClass('invisible animate__fadeOutRight');
        $('#volumeSpan').addClass('fade-in-fwd');
    });

    $('#audioButton').on('mouseleave', function () {
        $('#audioButton').attr('src','assets/images/svg/volume-on.svg');
    });

    $('#volumeSpan').on('mouseleave', function () {
        $('#volumeSpan').removeClass('fade-in-fwd');
        $('#volumeSpan').addClass('animate__fadeOutRight');
        
        setTimeout(() => {
            $('#volumeSpan').addClass('invisible');
        }, 1000);
    });
});

$(document).on('start-animation', function () {
    var footerNavFirstIntervalRef;
    var footerNavSecondIntervalRef;

    setTimeout(() => {
        $('#footerNavUl').removeClass('invisible');
        $('#footerNavUl').addClass('bounce-in-left');
        footerInWaveAudio.play();
        
        footerNavFirstIntervalRef = setInterval(() => {
            $('#footerNavUl').removeClass('bounce-in-left');
            $('#footerNavUl').addClass('bounce-out-left');
            footerOutWaveAudio.play();

            footerNavSecondIntervalRef = setTimeout(() => {
                $('#footerNavUl').removeClass('bounce-out-left');
                $('#footerNavUl').addClass('bounce-in-left');
                footerInWaveAudio.play();
            }, 5000);
        }, 15000);
    }, 8500);

    $('#linkedInNav').on('mouseenter', function () {
        clearInterval(footerNavFirstIntervalRef);
        clearInterval(footerNavSecondIntervalRef);
        $('#footerNavUl').removeClass('bounce-in-left bounce-out-left');
        $('#linkedinIcon').attr('src', 'assets/images/svg/linkedin-hover.svg');
        $('#linkedInNav').addClass('animate__headShake');
    });

    $('#linkedInNav').on('mouseleave', function () {
        $('#linkedinIcon').attr('src', 'assets/images/svg/linkedin.svg');
        $('#linkedInNav').removeClass('animate__headShake');

        footerNavFirstIntervalRef = setInterval(() => {
            $('#footerNavUl').removeClass('bounce-in-left');
            $('#footerNavUl').addClass('bounce-out-left');
            footerOutWaveAudio.play();

            footerNavSecondIntervalRef = setTimeout(() => {
                $('#footerNavUl').removeClass('bounce-out-left');
                $('#footerNavUl').addClass('bounce-in-left');
                footerInWaveAudio.play();
            }, 5000);
        }, 15000);
    });

    $('#telegramNav').on('mouseenter', function () {
        clearInterval(footerNavFirstIntervalRef);
        clearInterval(footerNavSecondIntervalRef);
        $('#footerNavUl').removeClass('bounce-in-left bounce-out-left');
        $('#telegramIcon').attr('src', 'assets/images/svg/telegram-hover.svg');
        $('#telegramNav').addClass('animate__headShake');
    });

    $('#telegramNav').on('mouseleave', function () {
        $('#telegramIcon').attr('src', 'assets/images/svg/telegram.svg');
        $('#telegramNav').removeClass('animate__headShake');

        footerNavFirstIntervalRef = setInterval(() => {
            $('#footerNavUl').removeClass('bounce-in-left');
            $('#footerNavUl').addClass('bounce-out-left');
            footerOutWaveAudio.play();

            footerNavSecondIntervalRef = setTimeout(() => {
                $('#footerNavUl').removeClass('bounce-out-left');
                $('#footerNavUl').addClass('bounce-in-left');
                footerInWaveAudio.play();
            }, 5000);
        }, 15000);
    });

    $('#emailNav').on('mouseenter', function () {
        clearInterval(footerNavFirstIntervalRef);
        clearInterval(footerNavSecondIntervalRef);
        $('#footerNavUl').removeClass('bounce-in-left bounce-out-left');
        $('#emailIcon').attr('src', 'assets/images/svg/email-hover.svg');
        $('#emailNav').addClass('animate__headShake');
    });

    $('#emailNav').on('mouseleave', function () {
        $('#emailIcon').attr('src', 'assets/images/svg/email.svg');
        $('#emailNav').removeClass('animate__headShake');

        footerNavFirstIntervalRef = setInterval(() => {
            $('#footerNavUl').removeClass('bounce-in-left');
            $('#footerNavUl').addClass('bounce-out-left');
            footerOutWaveAudio.play();

            footerNavSecondIntervalRef = setTimeout(() => {
                $('#footerNavUl').removeClass('bounce-out-left');
                $('#footerNavUl').addClass('bounce-in-left');
                footerInWaveAudio.play();
            }, 5000);
        }, 15000);
    });
});


$(document).on('start-animation', function () {
    var donateBAnimationList = ['animate__jello', 'vibrate-3'];
    var donateBAnimationIndex = 0;
    var donateBIntervalRef;

    setTimeout(() => {
        $('#donateDiv').removeClass('invisible');
        $('#donateDiv').addClass('shake-horizontal');
        $('#donateButton').addClass('slide-in-bottom');
        
        donateBIntervalRef = setInterval(() => {
            $('#donateButton').removeClass('slide-in-bottom');
            $('#donateButton').removeClass(donateBAnimationList[donateBAnimationIndex]);
            donateBAnimationIndex = nextNumber(donateBAnimationIndex, donateBAnimationList.length, false);
            $('#donateButton').addClass(donateBAnimationList[donateBAnimationIndex]);
            donateButtonShakeAudio.play();
        }, 16000);
}, 21000);

$('#donateButton').on('mouseenter', function () {
    clearInterval(donateBIntervalRef);
    $('#donateButton').removeClass(donateBAnimationList[donateBAnimationIndex]);
    $('#donateButton').attr('src','assets/images/svg/donate-chest-opened.svg');
});

$('#donateButton').on('mouseleave', function () {
    $('#donateButton').attr('src','assets/images/svg/donate-chest-closed.svg');

    donateBIntervalRef = setInterval(() => {
        $('#donateButton').removeClass('slide-top');
        $('#donateButton').removeClass(donateBAnimationList[donateBAnimationIndex]);
        donateBAnimationIndex = nextNumber(donateBAnimationIndex, donateBAnimationList.length, false);
        $('#donateButton').addClass(donateBAnimationList[donateBAnimationIndex]);
        donateButtonShakeAudio.play();
    }, 16000);
});
});

$(document).on('start-animation', function () {
    var linkAnimationList = ['animate__shakeX', 'animate__shakeY', 'animate__swing', 'animate__flip'];
    var linkAudioList = [orderLinkAudioFour, orderLinkAudioOne, orderLinkAudioTwo, orderLinkAudioThree];
    var linkAnimationIndex = 0;
    var linkAudioIndex = 0;
    var linkIntervalRef;

    setTimeout(() => {
        $('#orderLink').removeClass('invisible');
        $('#orderLink').addClass('animate__slower animate__zoomInUp');

        linkIntervalRef = setInterval(() => {
            $('#orderLink').removeClass('animate__slower animate__zoomInUp');
            $('#orderLink').removeClass(linkAnimationList[linkAnimationIndex]);
            linkAnimationIndex = nextNumber(linkAnimationIndex, linkAnimationList.length, false);
            linkAudioIndex = nextNumber(linkAudioIndex, linkAudioList.length, false);
            $('#orderLink').addClass(linkAnimationList[linkAnimationIndex]);
            linkAudioList[linkAudioIndex].play();
        }, 15000);
    }, 11500);

$('#orderLink').on('mouseenter', function () {
    clearInterval(linkIntervalRef);
    $('#orderLink').removeClass(linkAnimationList[linkAnimationIndex]);
    $('#orderLink').animate({fontSize:"110%"}, 150);
    $('#clickMessage').removeClass('invisible animate__zoomOut');
    $('#clickMessage').addClass('animate__flash');
});

$('#orderLink').on('mouseleave', function () {
    $('#orderLink').animate({fontSize:"100%"}, 200);
    $('#clickMessage').removeClass('animate__flash');
    $('#clickMessage').addClass('animate__zoomOut');

    linkIntervalRef = setInterval(() => {
        $('#orderLink').removeClass('animate__slower animate__zoomInUp');
        $('#orderLink').removeClass(linkAnimationList[linkAnimationIndex]);
        linkAnimationIndex = nextNumber(linkAnimationIndex, linkAnimationList.length, false);
        linkAudioIndex = nextNumber(linkAudioIndex, linkAudioList.length, false);
        $('#orderLink').addClass(linkAnimationList[linkAnimationIndex]);
        linkAudioList[linkAudioIndex].play();
    }, 15000);
});
});

    // $(document).on('start-animation', function () {
    // var orderBAnimationList = ['animate__heartBeat', 'animate__rubberBand', 'animate__wobble','animate__slower animate__bounceOutUp','animate__bounceInDown','animate__flash'];
    // var orderBAudioList = [orderButtonAudioOne];
    // var orderBAnimationIndex = 0;
    // var orderBAudioIndex = 0;
    // var orderBIntervalRef;
    
    // setTimeout(() => {
    //     $('#orderButton').removeClass('invisible');
    //     $('#orderButton').addClass('animate__tada');
    //     orderBIntervalRef = setInterval(() => {
    //         $('#orderButton').removeClass('animate__tada');
    //         $('#orderButton').removeClass(orderBAnimationList[orderBAnimationIndex]);
    //         orderBAnimationIndex = nextNumber(orderBAnimationIndex, orderBAnimationList.length, false);
    //         orderBAudioIndex = nextNumber(orderBAudioIndex, orderBAudioList.length, false);
    //         $('#orderButton').addClass(orderBAnimationList[orderBAnimationIndex]);
    //         orderBAudioList[orderBAudioIndex].play();
    //     }, 8000);
    // }, 18000);
    
    // $('#orderButton').on('mouseenter', function () {
    //     clearInterval(orderBIntervalRef);
    //     $('#orderButton').removeClass(orderBAnimationList[orderBAnimationIndex]);
    //     $('#orderButton').removeClass('animate__jello animate__tada');
    //     $('#orderButton').addClass('animate__pulse animate__faster orderButtonHover');
    // });
    
    // $('#orderButton').on('mouseleave', function () {
    //     $('#orderButton').removeClass('animate__pulse animate__faster orderButtonHover');
    //     $('#orderButton').addClass('animate__jello');
    
    //     orderBIntervalRef = setInterval(() => {
    //         $('#orderButton').removeClass('animate__tada');
    //         $('#orderButton').removeClass(orderBAnimationList[orderBAnimationIndex]);
    //         orderBAnimationIndex = nextNumber(orderBAnimationIndex, orderBAnimationList.length, false);
    //         orderBAudioIndex = nextNumber(orderBAudioIndex, orderBAudioList.length, false);
    //         $('#orderButton').addClass(orderBAnimationList[orderBAnimationIndex]);
    //         orderBAudioList[orderBAudioIndex].play();
    //     }, 8000);
    // });
    // });